{"metadata":{"guid":"264f8509-4ed6-41dc-9a31-70adbeadbdff","url":"/v2/streaming_pipelines/264f8509-4ed6-41dc-9a31-70adbeadbdff","created_at":"2018-03-23T20:02:17Z","updated_at":"2018-04-19T19:02:02Z","revision":1524164522903},"entity":{"name":"Cloudant to Db2 streams flow","description":"","project_guid":"9e53bd07-ee6d-4337-ad30-81191353bad7","graph":{"doc_type":"pipeline","version":"1.0","json_schema":"http://www.ibm.com/ibm/wdp/flow-v1.0/pipeline-flow-v1-schema.json","id":"","app_data":{"ui_data":{"name":"Cloudant to Db2 streams flow"}},"primary_pipeline":"primary-pipeline","pipelines":[{"id":"primary-pipeline","runtime":"streams","nodes":[{"id":"code_etw4bub2vtf","type":"binding","op":"ibm.streams.sources.code","outputs":[{"id":"target","schema_ref":"schema0","links":[{"node_id_ref":"dashdb_6srey7s6m8d","port_id_ref":"source"}]}],"parameters":{"code":"from cloudant import Cloudant\n\n\n# init() function will be called once on pipeline initialization\n# @state a Python dictionary object for keeping state. The state object is passed to the produce function\n\n\ndef init(state):\n    # do something once on pipeline initialization and save in the state object\n    pass\n\n\n# produce() function will be called when the job starts to run.\n# It is called on a background thread, and it will typically invoke the 'submit()' callback\n# whenever a tuple of data is ready to be emitted from this operator.\n# This allows for using asynchronous data services as well as synchronous data generation or retrieval.\n# @submit a Python callback function that takes one argument: a dictionary representing a single tuple.\n# @state a Python dictionary object for keeping state\n# You must declare all output attributes in the Edit Schema window.\ndef produce(submit, state):\n    # Replace with your Cloudant credentials\n    # Note: In general, 'account' is the username.\n    client = Cloudant(\n        'username',\n        'password',\n        account='account',\n        connect=True\n    )\n    db = client['animaldb']\n    feed = db.changes(feed='continuous', include_docs=True)\n    for change in feed:\n        doc = change['doc']\n        # Submit the doc in each iteration:\n        submit(doc)","schema_mapping":[{"name":"diet","type":"string","length":0,"source_elem_name":"","target_elem_name":""},{"name":"class","type":"string","length":0,"source_elem_name":"","target_elem_name":""},{"name":"wiki_page","type":"string","length":0,"source_elem_name":"","target_elem_name":""},{"name":"latin_name","type":"string","length":0,"source_elem_name":"","target_elem_name":""},{"name":"max_length","type":"double","length":0,"source_elem_name":"","target_elem_name":""},{"name":"min_length","type":"double","length":0,"source_elem_name":"","target_elem_name":""},{"name":"max_weight","type":"double","length":0,"source_elem_name":"","target_elem_name":""},{"name":"min_weight","type":"double","length":0,"source_elem_name":"","target_elem_name":""},{"name":"_deleted","type":"boolean","length":0,"source_elem_name":"","target_elem_name":""},{"name":"_rev","type":"string","length":0,"source_elem_name":"","target_elem_name":""},{"name":"_id","type":"string","length":0,"source_elem_name":""}]},"app_data":{"ui_data":{"label":"Code","x_pos":-570,"y_pos":160}}},{"id":"dashdb_6srey7s6m8d","type":"binding","op":"ibm.streams.targets.dashdb","parameters":{"schema_mapping":[{"name":"max_length","type":"double","length":0,"source_elem_name":"","target_elem_name":"max_length"},{"name":"min_length","type":"double","length":0,"source_elem_name":"","target_elem_name":"min_length"},{"name":"latin_name","type":"string","length":0,"source_elem_name":"","target_elem_name":"latin_name"},{"name":"_deleted","type":"boolean","length":0,"source_elem_name":"","target_elem_name":"_deleted"},{"name":"diet","type":"string","length":0,"target_elem_name":"diet"},{"name":"class","type":"string","length":0,"target_elem_name":"class"},{"name":"max_weight","type":"double","length":0,"target_elem_name":"max_weight"},{"name":"min_weight","type":"double","length":0,"target_elem_name":"min_weight"},{"name":"wiki_page","type":"string","length":0,"target_elem_name":"wiki_page"},{"name":"_rev","type":"string","length":0,"target_elem_name":"_rev"},{"name":"_id","type":"string","length":0,"target_elem_name":"_id"}]},"connection":{"ref":"91b3ebcd-6356-4285-90b0-23e302b5a193","project_ref":"9e53bd07-ee6d-4337-ad30-81191353bad7","properties":{"asset":{"path":"/DASH7751/ANIMALS","asset_types":[],"assets":[],"fields":[{"name":"_id","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}},{"name":"_rev","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}},{"name":"_deleted","type":{"type":"boolean","length":1,"scale":0,"nullable":true,"signed":false}},{"name":"min_weight","type":{"type":"double","length":53,"scale":0,"nullable":true,"signed":true}},{"name":"max_weight","type":{"type":"double","length":53,"scale":0,"nullable":true,"signed":true}},{"name":"min_length","type":{"type":"double","length":53,"scale":0,"nullable":true,"signed":true}},{"name":"max_length","type":{"type":"double","length":53,"scale":0,"nullable":true,"signed":true}},{"name":"latin_name","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}},{"name":"wiki_page","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}},{"name":"class","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}},{"name":"diet","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}}],"extended_metadata":[],"first":{"href":"https://api.dataplatform.ibm.com/v2/connections/91b3ebcd-6356-4285-90b0-23e302b5a193/assets?project_id=9e53bd07-ee6d-4337-ad30-81191353bad7&offset=0&limit=100&path=%2FDASH7751%2FANIMALS"},"total_count":1,"logs":[]}}},"app_data":{"ui_data":{"label":"Db2 Warehouse on Cloud","x_pos":-280,"y_pos":160}}}]}],"schemas":[{"id":"schema0","fields":[{"name":"diet","type":"string"},{"name":"class","type":"string"},{"name":"wiki_page","type":"string"},{"name":"latin_name","type":"string"},{"name":"max_length","type":"double"},{"name":"min_length","type":"double"},{"name":"max_weight","type":"double"},{"name":"min_weight","type":"double"},{"name":"_deleted","type":"boolean"},{"name":"_rev","type":"string"},{"name":"_id","type":"string"}]}]},"engines":{"streams":{"instance_id":"f23160b7-6412-43c2-bdf8-bc598b2af4be"}}}}